{"ledger_id":"led_01KGAHB6N028ADRCCMH2K526PV","ts":"2026-01-31T17:24:23.328598Z","author":"ingest-agent","reason":"Create a concise source summary of the JJ Gateway v0.1 plan/spec for future reference by implementation agents.","op":"upsert_knowledge","doc_path":"summaries/sources/jj-gateway-v-0.md","doc_id":"mem_01KGAHB6MZ6CGJNQKQSTC1JQTY","new_hash":"4553feea99f27fb1cbc3421eea3054ba2eccdb735fee753a295edfa6b665a8e2","patch":{"doc_path":"summaries/sources/jj-gateway-v-0.md","title":"JJ Gateway v0.1 — Formal Plan / Spec (CLI + Telegram)","type":"source_summary","status":"active","tags_add":["jj","gateway","spec","cli","telegram","event-sourcing","websocket"],"confidence":0.9,"body_append":"## Summary\n\nJJ Gateway v0.1 specifies a first shippable “Gateway + Agent Loop” system with two message channels—local CLI (`jj chat`) and Telegram bot—both routed through a single local daemon (`jj gateway`). The Gateway is the control plane: it manages sessions, persists transcripts, coordinates a per-session serialized agent run loop (LLM streaming), and routes outbound responses back to the originating channel.\n\nCore design principles: session key is the unit of consistency; all state is derived from an append-only event log (JSONL transcript per session); the daemon is crash-only and restart-safe via replay/rehydration from `sessions.json` + transcripts; idempotency is required to make retries safe and prevent duplicate side effects (notably for Telegram update delivery and client reconnect retries).\n\nArchitecture components: Gateway Core (session manager, run coordinator, model provider interface, internal event bus/router), CLI Adapter (WebSocket client with streaming display and reconnect/resubscribe), and Telegram Adapter (long polling via `getUpdates`, mapping `tg:<chat_id>` to session keys, dedupe via durable offset/update tracking, and outbound `sendMessage`). Concurrency model: one active run per session key; cross-session concurrency allowed with a configurable global cap.\n\nPersistence layout defaults to `~/.jj/gateway/` with `sessions.json` as a small index (metadata + channel bindings) and `transcripts/<session_id>.jsonl` as source-of-truth logs (header + typed entries: `message`, `assistant_delta` optional, `assistant_final`, `error`). Idempotency can be implemented with a dedicated `dedupe/` store or via scanning recent transcript lines.\n\nGateway API for CLI: JSON frames over loopback WebSocket (`gateway.hello`, `session.open`, `session.send`, `session.subscribe`, `session.history`, dev-only `gateway.shutdown`), and events (`run.started`, `assistant.delta`, `assistant.final`, `run.completed`, `error`). Config lives at `~/.jj/gateway/config.toml` with sections for gateway, model provider, and Telegram; secrets must be env-var only. Deliverables include Rust workspace layout, tests (persistence, idempotency, WS happy path, Telegram dedupe with mocks), and docs (quickstart/protocol/storage).","sources_add":[{"thread_id":"","event_ids":["src_01KGAH9QWXDTVYBKPNG42FDGDE"]}]}}
{"ledger_id":"led_01KGAHB6N1VNP9KP1SAR1S2ZAE","ts":"2026-01-31T17:24:23.329426Z","author":"ingest-agent","reason":"Record the JJ Gateway v0.1 effort as a concrete project with deliverables, components, milestones, and acceptance criteria.","op":"upsert_knowledge","doc_path":"knowledge/projects/jj-gateway.md","doc_id":"mem_01KGAHB6N1NY1HKH25H9JYNZSM","new_hash":"92cd9c3ef34c8b0c7b0e9c6b3d3d91bc4efed04675b34ba297901f8ca1170e46","patch":{"doc_path":"knowledge/projects/jj-gateway.md","title":"JJ Gateway (v0.1)","type":"project","status":"active","tags_add":["jj","gateway","daemon","cli","telegram","rust","websocket","event-sourcing"],"confidence":0.9,"body_append":"## Overview\n\nJJ Gateway v0.1 is a local “control plane” daemon (`jj gateway`) plus channel adapters that together provide durable, replayable chat sessions and an agent execution loop. Channels in v0.1: local CLI REPL (`jj chat`) and Telegram bot (long polling). All inbound/outbound messages flow through the Gateway.\n\n## Goals (v0.1)\n\n- One long-running daemon that owns:\n  - session storage/index and transcripts\n  - message intake from CLI + Telegram\n  - per-session serialized agent loop with LLM streaming\n  - outbound routing back to channels\n- Durable sessions: append-only per-session transcripts (`.jsonl`) + `sessions.json` index.\n- Restart-safe/crash-only operation; idempotency for side-effecting operations.\n\n## Non-goals (deferred)\n\n- Multi-node device capabilities (camera/screen/etc)\n- Tool/plugin marketplace, deep tool system\n- Subagents/lanes beyond minimal per-session serialization\n- Cron scheduler\n- Full web UI\n\n## Key design principles\n\n- Session key is unit of consistency; only one active run per session key.\n- Event log is source of truth; state derived from transcripts.\n- Crash-only + replayable via rehydration from `sessions.json` + transcript JSONL.\n- Idempotency for protocol methods and inbound message dedupe.\n\n## Components\n\n- **Gateway Core**: session manager, run coordinator, model provider interface, internal event bus, channel router.\n- **CLI Adapter**: `jj chat` WebSocket client with streaming output, reconnect/resubscribe.\n- **Telegram Adapter**: long polling `getUpdates`, map `tg:<chat_id>` to sessions, dedupe, outbound `sendMessage`.\n\n## Storage\n\nDefault root: `~/.jj/gateway/`\n- `sessions.json` (small index/metadata)\n- `transcripts/<session_id>.jsonl` (append-only header + typed entries)\n- optional: `dedupe/`, `logs/` (stream capture)\n\n## Protocol/API (loopback WebSocket)\n\nClient frames:\n- req: `{type:req,id,method,params,idempotency_key}`\n- res: `{type:res,id,ok,payload}`\n- event: `{type:event,event,payload,seq}`\n\nMethods (v0.1): `gateway.hello`, `session.open`, `session.send`, `session.subscribe`, `session.history`, dev-only `gateway.shutdown`.\n\nEvents: `run.started`, `assistant.delta`, `assistant.final`, `run.completed`, `error`.\n\n## Configuration\n\nConfig file: `~/.jj/gateway/config.toml` (or `--config`). Sections:\n- `[gateway]` port, data_dir, log_level, max_concurrency\n- `[model]` provider, model, api_key_env\n- `[telegram]` enabled, bot_token_env, allow_chat_ids\n\nSecrets via env vars only; never written to transcripts/logs.\n\n## Milestones\n\n- M0 scaffold: daemon starts, WS handshake, CLI connects\n- M1 sessions + persistence\n- M2 agent loop streaming (CLI)\n- M3 Telegram adapter + restart-safe dedupe\n- M4 hardening (idempotency store, backoff/retry, shutdown)\n\n## Definition of Done highlights\n\n- Rust workspace: `crates/jj-gateway`, `crates/jj-cli`, `crates/jj-proto`, plus docs/examples.\n- `cargo build --workspace` + `cargo test --workspace` pass.\n- Restart-safe sessions/history; idempotent `session.send` does not duplicate transcript entries.\n- Telegram allowlist default-deny; restart does not replay old updates.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAH9QWXDTVYBKPNG42FDGDE"]}]}}
{"ledger_id":"led_01KGAHB6N2EZSK07NEJCVAGZVR","ts":"2026-01-31T17:24:23.330121Z","author":"ingest-agent","reason":"Capture system-level facts about JJ Gateway v0.1 architecture, storage, protocol, and operational invariants that other agents can rely on.","op":"upsert_knowledge","doc_path":"knowledge/system/jj-gateway-architecture.md","doc_id":"mem_01KGAHB6N1JNPM0C723JVFMMXQ","new_hash":"fc37ba140aa419e2affc24b408a0840b27ed21eb119ae1ca0849900ce3b0abb8","patch":{"doc_path":"knowledge/system/jj-gateway-architecture.md","title":"JJ Gateway v0.1 system architecture & invariants","type":"system","status":"active","tags_add":["jj","gateway","architecture","event-sourcing","idempotency","sessions","websocket","telegram"],"confidence":0.9,"body_append":"## Core invariants\n\n- **Gateway is the control plane**: all channel messages (CLI, Telegram) are normalized into internal events and flow through the daemon.\n- **Session key is the unit of consistency**: one serialized agent run per `session_key`.\n- **Event log is source of truth**: state is derived from append-only per-session transcript JSONL.\n- **Crash-only + replayable**: restart rehydrates from `sessions.json` + transcript logs.\n- **Idempotency everywhere**: retries must be safe across restarts/network failures.\n\n## Concurrency model (v0.1)\n\n- Per-session lock ensures only one active run per `session_key`.\n- Cross-session concurrency allowed; capped by configurable global semaphore (`max_concurrency`).\n\n## Channels / adapters\n\n- **CLI**: `jj chat` WebSocket client connects to loopback server, subscribes to session events, displays streaming deltas.\n- **Telegram**: long polling `getUpdates`, maps chats to `session_key = tg:<chat_id>`, ignores non-text messages in v0.1, sends final responses with `sendMessage`.\n\n## Storage layout\n\nDefault root: `~/.jj/gateway/`\n- `sessions.json` (index: `session_key -> {session_id, metadata, channel bindings, model flags}`)\n- `transcripts/<session_id>.jsonl` (append-only)\n- optional: `dedupe/` (idempotency records), `logs/` (raw stream capture)\n\n### Transcript entry types (v0.1 minimal)\n\n- `header` (first line)\n- `message` (user)\n- `assistant_delta` (optional/debug)\n- `assistant_final`\n- `error`\n\n## Gateway WebSocket protocol\n\n- Request frame: `{ \"type\":\"req\", \"id\":\"uuid\", \"method\":\"...\", \"params\":{...}, \"idempotency_key\":\"...\" }`\n- Response frame: `{ \"type\":\"res\", \"id\":\"uuid\", \"ok\":true, \"payload\":{...} }`\n- Event frame: `{ \"type\":\"event\", \"event\":\"assistant.delta\", \"payload\":{...}, \"seq\":123 }`\n\nRequired methods: `gateway.hello`, `session.open`, `session.send`, `session.subscribe`, `session.history`, dev-only `gateway.shutdown`.\n\nEvents: `assistant.delta`, `assistant.final`, `run.started`, `run.completed`, `error`.\n\n## Configuration\n\n`~/.jj/gateway/config.toml` sections:\n- `[gateway]` port, data_dir, log_level, max_concurrency\n- `[model]` provider, model, api_key_env\n- `[telegram]` enabled, bot_token_env, allow_chat_ids\n\nSecrets are loaded from environment variables and must not be persisted in transcripts/logs.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAH9QWXDTVYBKPNG42FDGDE"]}]}}
{"ledger_id":"led_01KGAHB6N2V9Z8NHWTAGBXSS7J","ts":"2026-01-31T17:24:23.330820Z","author":"ingest-agent","reason":"Extract explicit preference-like requirements around security, secrets handling, and minimal v0.1 scope from the spec.","op":"upsert_knowledge","doc_path":"knowledge/prefs/jj-gateway-v0-constraints.md","doc_id":"mem_01KGAHB6N20MV56DR4WKR1KMDS","new_hash":"7876a3023b5f1c9dfdcc09d6480ec5e3f0503ca8efb6792763f9fde95f2e3386","patch":{"doc_path":"knowledge/prefs/jj-gateway-v0-constraints.md","title":"JJ Gateway v0.1 constraints & preferences","type":"preference","status":"active","tags_add":["jj","gateway","preferences","security","scope","operations"],"confidence":0.85,"body_append":"## Scope preferences\n\n- v0.1 focuses on a single-node local daemon + two channels (CLI + Telegram) with durable sessions.\n- Defer: web UI, cron, subagents/lanes, tool marketplace, multi-device capabilities.\n\n## Operational preferences\n\n- **Crash-only daemon**: prefer restart over in-place upgrades; continuity via transcripts + session index.\n- Provide graceful shutdown (`SIGINT`/`SIGTERM` + dev-only `gateway.shutdown`).\n\n## Security/safety preferences (v0.1 minimal)\n\n- Gateway should listen on **loopback only** (no remote access).\n- Telegram adapter should be **default deny** via allowlist of chat IDs (or user IDs later).\n- No remote admin endpoints.\n\n## Secrets handling\n\n- Never store model API keys or Telegram bot tokens in transcripts.\n- Load secrets only via environment variables specified in config (e.g., `OPENAI_API_KEY`, `TELEGRAM_BOT_TOKEN`).\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAH9QWXDTVYBKPNG42FDGDE"]}]}}
{"ledger_id":"led_01KGAHFNG382EZDNTJ58GC69N0","ts":"2026-01-31T17:26:49.603307Z","author":"ingest-agent","reason":"Create a source summary for the provided 'claude.md from an earlier assistant' document for future reference.","op":"upsert_knowledge","doc_path":"summaries/sources/claude-md-from-an-earlier-assistant.md","doc_id":"mem_01KGAHFNG2H41C12GRWJE9KAFD","new_hash":"fc9f15c91df8ae875395a2021faef04f550d0966c60674ea339345b3f9d6cf5b","patch":{"doc_path":"summaries/sources/claude-md-from-an-earlier-assistant.md","title":"claude.md from an earlier assistant — CTO Assistant Guide (source summary)","type":"source_summary","tags_add":["source","assistant-guide","loopwork"],"confidence":0.86,"body_append":"## Summary\nThis document defines a lightweight operating manual for a “CTO Assistant” that acts as a thought partner to **Jesse Andrews** at **LoopWork**. The assistant should use a **telegraphic style** (minimal filler/grammar, minimal tokens) and be explicit about blockers (state what’s missing). It is explicitly **not** a coding agent; separate agents do implementation, though the assistant can write code for research/investigation.\n\nThe workflow is structured around persistent context management: at **session start**, read `priorities.md` and relevant files under `context/`. At **session end**, update `priorities.md` if priorities changed, add new information to `context/*.md`, and record significant technical decisions in `decisions/` using an ADR format. The file itself is meant to hold only pointers, with details living in `context/`, `ideas/`, and `decisions/`.\n\nOperational environment notes include repository locations: LoopWork work lives under `~/lw` (clone missing repos from `https://github.com/loopwork/<repo>.git`), and open-source work under `~/oss`. For web research, the assistant should search early, quote exact errors, and prefer sources from **2025–2026**.\n\nCompany/product context captured: LoopWork is pre-product with roughly **$2M runway**; Jesse is CTO (Berkeley) and **Carl** is CEO (SF). The team’s Q1 2025 direction was “Cursor/Claude Code for media,” starting with **images**, after pivoting from **Vibewire** (dev tools; oversaturated). A core technical effort is **Sparks** (`~/lw/sparks`): “agentic-first cloud compute” offering instant sandboxed containers and **btrfs snapshots**. The thesis is that AI apps feel “dead” when frozen; agentic behavior is central to the product.\n\nThe document also sketches an “AI Context Corpus” vision: capturing conversations and consumption as durable context (Granola transcripts, Readwise Reader highlights, a YouTube summarizer tool `~/lw/yt` storing data in `~/.yt/videos/`, chat exports, Claude logs, and a code-change changelog service). Key insight (2025-01-24): “The conversations themselves ARE the context.”\n\n## Noted unknowns / gaps\n- Carl’s background/focus\n- ZOMG code location + learnings\n- Target image workflows\n- Granola API options\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHEDMYRPF9ZX0JNVZ8T2SZ"]}]}}
{"ledger_id":"led_01KGAHFNG4RY23ZTHN68ZPGR95","ts":"2026-01-31T17:26:49.604918Z","author":"ingest-agent","reason":"Add/normalize a person record for Jesse Andrews, capturing biographical and working-style details referenced in the source.","op":"upsert_knowledge","doc_path":"knowledge/people/jesse-andrews.md","doc_id":"mem_01KGAHFNG411EGWX99WTQR7S7Q","new_hash":"1748b130c299439abafee78c7a01c2b28b41927ddc821ab015eead13aab0c06c","patch":{"doc_path":"knowledge/people/jesse-andrews.md","title":"Jesse Andrews","type":"person","tags_add":["loopwork"],"confidence":0.84,"body_append":"## Role\n- CTO at **LoopWork** (based in Berkeley).\n\n## Background (as stated)\n- Creator of **OpenStack** (NASA).\n- Former **SVP Product/Eng at Planet**, leading a ~75 person org.\n- Worked on AI topics including **embeddings** and **autoencoders** (2018–2021).\n- Creator of **userscripts.org**.\n- **Sparks** is described as his first Rust project.\n\n## Working style / beliefs\n- Thinks in metaphors of **cloud as magic** (shifting time/space), **agents as outsourced dev**, and highlights cross-discipline communication gaps.\n- In pre-product phase: values **speed over perfection**; avoid over-engineering.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHEDMYRPF9ZX0JNVZ8T2SZ"]}]}}
{"ledger_id":"led_01KGAHFNG5YD2D37VM9QXYSED5","ts":"2026-01-31T17:26:49.605424Z","author":"ingest-agent","reason":"Create a person stub for Carl (LoopWork CEO) so future notes can attach background/focus as it becomes known.","op":"upsert_knowledge","doc_path":"knowledge/people/carl-loopwork.md","doc_id":"mem_01KGAHFNG5CYPBCMPZXSJHHGMZ","new_hash":"657e832556b7b9ba364f7147e2c45ea2321a9648dad869969d913e614e9671aa","patch":{"doc_path":"knowledge/people/carl-loopwork.md","title":"Carl (LoopWork)","type":"person","tags_add":["loopwork"],"confidence":0.6,"body_append":"## Role\n- CEO at **LoopWork** (based in San Francisco).\n\n## Open questions\n- Background/focus not yet captured in the source notes.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHEDMYRPF9ZX0JNVZ8T2SZ"]}]}}
{"ledger_id":"led_01KGAHFNG6EB39C469ZBY5Z4AV","ts":"2026-01-31T17:26:49.606317Z","author":"ingest-agent","reason":"Create/update a project/org record for LoopWork with the specific product direction, runway, and pivots referenced in the source.","op":"upsert_knowledge","doc_path":"knowledge/projects/loopwork.md","doc_id":"mem_01KGAHFNG64TGPDAAK8S7XM98S","new_hash":"2e9e3f240ee8d46a59ebd567068e0dd673719c8913801abd40294d547da0494d","patch":{"doc_path":"knowledge/projects/loopwork.md","title":"LoopWork","type":"project","tags_add":["company","pre-product"],"confidence":0.82,"body_append":"## Snapshot (2025-01-24)\n- Team: **Jesse Andrews** (CTO, Berkeley) + **Carl** (CEO, SF).\n- Stage: **pre-product**.\n- Runway: ~**$2M** (as stated).\n\n## Direction\n- Q1 2025 concept: “**Cursor/Claude Code for media**” starting with **images first**.\n- Pivoted from **Vibewire** (dev tools), described as an oversaturated space.\n\n## Repos / local layout\n- Work directory: `~/lw`.\n- If a repo is missing: `git clone https://github.com/loopwork/<repo>.git`.\n- Open-source directory: `~/oss`.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHEDMYRPF9ZX0JNVZ8T2SZ"]}]}}
{"ledger_id":"led_01KGAHFNG6098334YKVN4WK72M","ts":"2026-01-31T17:26:49.606729Z","author":"ingest-agent","reason":"Create/update a project record for Sparks, the core infra effort described in the source.","op":"upsert_knowledge","doc_path":"knowledge/projects/sparks.md","doc_id":"mem_01KGAHFNG68QP9XNES1WAH76PT","new_hash":"a06ca9f60464f12efdc85a3b8b9c3e6069c86e22b762855cd0b57b23499f7a13","patch":{"doc_path":"knowledge/projects/sparks.md","title":"Sparks","type":"project","tags_add":["loopwork","infrastructure"],"confidence":0.83,"body_append":"## Overview\n- Location: `~/lw/sparks`.\n- Described as LoopWork’s **core infrastructure**.\n\n## Product/technical thesis\n- “Agentic-first cloud compute”: provide **instant sandboxed containers** and fast state management via **btrfs snapshots**.\n- Thesis statement: AI apps feel “dead” when frozen; the **agentic nature is the product**.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHEDMYRPF9ZX0JNVZ8T2SZ"]}]}}
{"ledger_id":"led_01KGAHFNG7KX3JNCPQANFQPG2Y","ts":"2026-01-31T17:26:49.607332Z","author":"ingest-agent","reason":"Capture assistant interaction preferences and operating rules (telegraphic style, explicit blockers, web-search guidance, start/end session ritual).","op":"upsert_knowledge","doc_path":"knowledge/prefs/cto-assistant-operating-style.md","doc_id":"mem_01KGAHFNG7VP9996HX9YRCDGEM","new_hash":"b961fbf30f25ca3fffa96f43196b7c9f9b48e883fe37bb73768cbd764e7fca06","patch":{"doc_path":"knowledge/prefs/cto-assistant-operating-style.md","title":"CTO Assistant operating style (LoopWork)","type":"preference","tags_add":["style","workflow"],"confidence":0.86,"body_append":"## Writing style\n- **Telegraphic**: drop filler/grammar; minimize tokens.\n\n## Collaboration norms\n- If blocked: explicitly say **what’s missing**.\n- Push back when the user is wrong; ask clarifying questions when unclear.\n- Not a coding agent (implementation delegated), but can write code to investigate/research.\n\n## Web research\n- Search early.\n- Quote **exact errors**.\n- Prefer sources from **2025–2026** when possible.\n\n## Session ritual\n- Start: read `priorities.md` + relevant `context/`.\n- End: update `priorities.md` if shifted; add new info to `context/*.md`; record significant technical decisions in `decisions/` using ADR format.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHEDMYRPF9ZX0JNVZ8T2SZ"]}]}}
{"ledger_id":"led_01KGAHFNG79TSHQC1JXK3V8TY9","ts":"2026-01-31T17:26:49.607803Z","author":"ingest-agent","reason":"Record system/tooling facts about the emerging AI Context Corpus and the specific tools/paths mentioned (Granola, Readwise, yt tool, logs, changelog service).","op":"upsert_knowledge","doc_path":"knowledge/system/ai-context-corpus.md","doc_id":"mem_01KGAHFNG7BHAAG5DTF7X0K6K9","new_hash":"f017ee7ec2b415dc736b8bd10ba9dba862f9bcfe2f6762773ce5faec7a29ecfe","patch":{"doc_path":"knowledge/system/ai-context-corpus.md","title":"AI Context Corpus (LoopWork)","type":"system","tags_add":["context","tooling"],"confidence":0.8,"body_append":"## Goal\nCreate a durable “AI context corpus” by recording conversations and consumption so an AI can understand relationships, thinking evolution, and decision history.\n\n## Key insight\n- (2025-01-24) “**The conversations themselves ARE the context.**”\n\n## Inputs / sources\n- Calls/meetings: **Granola** transcripts (manual sharing now; integrate later).\n- Reading: **Readwise Reader** (read-later + highlights; has an API). Reference noted: `ideas/reader-plan.md`.\n- Videos: **yt tool** at `~/lw/yt` (YouTube summaries via Gemini); stores videos/summaries in `~/.yt/videos/`.\n- Chats: iMessage/Signal exports; potential future “Loop chat”.\n- Claude sessions: logs.\n- Code changes: changelog service (`ideas/changelog-service.md`).\n\n## Inspiration\n- Jeremy Howard’s close reading workflow: load enough context for the AI to understand relationships and evolution over time.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHEDMYRPF9ZX0JNVZ8T2SZ"]}]}}
{"ledger_id":"led_01KGAHKHMZNQ6MFZQ15ZC10MP6","ts":"2026-01-31T17:28:56.735375Z","author":"ingest-agent","reason":"Add source summary for the provided tech-stack document.","op":"upsert_knowledge","doc_path":"summaries/sources/tech-stack.md","doc_id":"mem_01KGAHKHMYCCWS0SHZ9F594J55","new_hash":"d0613ade23664c3e00bcdb894fb15a3ec864b078daece9802cff7b65f1ab0b24","patch":{"doc_path":"summaries/sources/tech-stack.md","title":"tech-stack","type":"source_summary","tags_add":["tech-stack","constraints","tbd"],"confidence":0.85,"body_append":"## Summary\nThis document is a placeholder for capturing **technical stack choices and engineering decisions**. It outlines four stack areas\u0014**Frontend**, **Backend**, **Infrastructure**, and **Third-party services**\u0014but all specific technology selections are currently **TBD**.\n\nIt also establishes an intent to document **technical principles** (a numbered list is present but empty) and explicitly records early **constraints** shaping decisions:\n- The team is **2 people**, with **1 technical** contributor.\n- The company is **pre-funding/bootstrapped**.\n- **Speed to market is critical**.\n\nThe document is marked as last updated **2025-01-23** and should be updated as concrete decisions are made.","sources_add":[{"thread_id":"","event_ids":["src_01KGAHK5ZJC13ZQXP7FV545M72"]}]}}
{"ledger_id":"led_01KGAHKVEG3HZFBK0VRS5X47T2","ts":"2026-01-31T17:29:06.768727Z","author":"ingest-agent","reason":"Capture explicit org-level constraints from the tech-stack source as a reusable system fact for future technical decisions.","op":"upsert_knowledge","doc_path":"knowledge/system/loopwork-org-constraints.md","doc_id":"mem_01KGAHKVEGM4RG43WN59VTW6P6","new_hash":"8f85e1a65000c0462f1141833524bfbf840a24c110cadb8bf823ac6fb9fef739","patch":{"doc_path":"knowledge/system/loopwork-org-constraints.md","title":"LoopWork org constraints (team/budget/speed)","type":"system","status":"active","tags_add":["loopwork","constraints","team","bootstrapped","speed"],"confidence":0.75,"body_append":"## Constraints (as of 2025-01-23)\n- Team size: **2-person team**, with **1 technical** contributor.\n- Funding stage: **pre-funding / bootstrapped**.\n- Priority: **speed to market is critical**.\n\n## Notes\n- This doc records organizational constraints that should shape technical stack decisions while the explicit stack remains TBD.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHK5ZJC13ZQXP7FV545M72"]}]}}
{"ledger_id":"led_01KGAHMXYWDC794JH3JV6Q54SE","ts":"2026-01-31T17:29:42.108547Z","author":"ingest-agent","reason":"Add a source summary capturing the OpenClaw gateway-centric architecture deep-dive for future reference and comparison with JJ Gateway.","op":"upsert_knowledge","doc_path":"summaries/sources/compass-artifact-wf-1cec5d07-e9be-4524-a854-c221ae1f9ce0-text-markdown.md","doc_id":"mem_01KGAHMXYWZ19MFDR049SD9KPE","new_hash":"62fd8b61963520a667d6f7d0eae10646bc9359261334dd03b4c2da7ced7c1444","patch":{"doc_path":"summaries/sources/compass-artifact-wf-1cec5d07-e9be-4524-a854-c221ae1f9ce0-text-markdown.md","title":"OpenClaw technical architecture deep-dive (gateway-centric agent framework)","type":"source_summary","status":"active","tags_add":["openclaw","gateway","agents","architecture","websocket","sessions","serialization","cron","heartbeats","tools","skills","typebox","security"],"confidence":0.86,"body_append":"## Summary\n\nThis document describes **OpenClaw**, a local-first, **gateway-centric AI agent framework** implemented in TypeScript on Node.js (≥22). A single long-running **Gateway daemon** acts as the control plane for **all messaging, session management, scheduling, and tool execution**. The Gateway owns channel connections (WhatsApp via Baileys, Telegram via grammY, Discord via discord.js, Slack via Bolt), enforces *one Gateway per host*, and exposes a loopback WebSocket control plane at `ws://127.0.0.1:18789`.\n\nClients (agent loop, CLI, WebChat UI, mobile nodes, internal scheduler) communicate with the Gateway using a typed JSON WebSocket protocol with frames `req`, `res`, and server-push `event` (streaming). The first frame must be an authenticated `connect` handshake; side-effecting methods (e.g., `agent`, `send`) require **idempotency keys** for safe retries.\n\nA core invariant is **per-session serialization**: inbound messages are routed by binding rules (channel/account/peer/guild; most-specific-wins) to an agent, then queued so only one run executes at a time per session key—analogous to a GenServer-per-session mailbox. The run pipeline is: intake/ack (`{runId, acceptedAt}`), queueing, context assembly (workspace files like `AGENTS.md`, `SOUL.md`, skills), model inference with tool calls, sandboxed tool execution with sanitization, streaming deltas over WebSocket, and persistence to JSONL transcripts with token accounting. Session keys are hierarchical (e.g., `agent:<agentId>:<channel>:dm:<peerId>`).\n\nScheduling is built into the Gateway via **cron jobs** and **heartbeats** (no separate scheduler daemon). Cron jobs can inject events into the main session or run in **isolated sessions** (`cron:<jobId>`) that post results back to main; jobs persist at `~/.openclaw/cron/jobs.json` and concurrency is bounded (`maxConcurrentRuns`). Heartbeats (default 30 min) run proactive checks driven by `HEARTBEAT.md`.\n\nCoordination relies on the Gateway control plane plus optional, allowlisted **agent-to-agent tools** (`sessions_send`, `sessions_spawn`). Sub-agents run in isolated sessions (`agent:<agentId>:subagent:<uuid>`) and cannot recursively spawn further subagents by default.\n\nDurable memory is file-based: daily append-only logs under `~/.openclaw/workspace/memory/YYYY-MM-DD.md`, curated `MEMORY.md`, and JSONL session transcripts. Each agent has an isolated workspace/session store/auth profile to prevent credential leakage.\n\nTools use **TypeBox** schemas for compile-time and runtime validation (with restrictions such as avoiding unions), and higher-level **Skills** are defined in `SKILL.md` with YAML frontmatter and a precedence order (workspace > managed > bundled) gated by environment/binaries/OS requirements. Tool access is controlled by per-agent allow/deny lists, presets, and tool groups.\n\nThe piece highlights patterns: single-daemon gateway control plane, provider/channel abstractions, session-based serialization, layered configuration, DI via a factory (`createDefaultDeps`), and security layering (DM/group policies → tool policy → sandbox → exec approvals). OpenClaw optimizes for single-user local deployment; horizontal scaling would require session affinity and shared state, representing a major architectural change.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHKH7MWX9B27SKEBRWXNJR"]}]}}
{"ledger_id":"led_01KGAHMXYXYRDPES1W4B3QP3XC","ts":"2026-01-31T17:29:42.109625Z","author":"ingest-agent","reason":"Capture OpenClaw as a discrete project entity referenced by the source (useful as an external reference architecture for JJ Gateway).","op":"upsert_knowledge","doc_path":"knowledge/projects/openclaw.md","doc_id":"mem_01KGAHMXYXVT7DX7HY5Z1GTE8E","new_hash":"17228deff0d4e0d275a21c098c21c4eb97d515fc268ca3178e119a77f086060a","patch":{"doc_path":"knowledge/projects/openclaw.md","title":"OpenClaw (gateway-centric AI agent framework)","type":"project","status":"active","tags_add":["openclaw","agent-framework","gateway","nodejs","typescript","websocket","scheduling","tools","skills"],"confidence":0.84,"body_append":"## Overview\n\nOpenClaw is a **gateway-centric AI agent framework** where a single long-running **Gateway daemon** functions as the control plane for:\n\n- channel adapters (WhatsApp/Baileys, Telegram/grammY, Discord/discord.js, Slack/Bolt, etc.)\n- session management and multi-agent routing\n- per-session run coordination (serialized queues)\n- tool execution (sandboxed) and streaming outputs\n- scheduling (cron jobs + heartbeats)\n\nImplemented in TypeScript on Node.js (≥22). The Gateway exposes a loopback WebSocket control plane at `ws://127.0.0.1:18789`.\n\n## Notable design points\n\n- **Single Gateway per host** (e.g., required for WhatsApp Web session ownership).\n- **Typed JSON WebSocket protocol** with `req`/`res`/`event` frames; authenticated `connect` handshake; idempotency keys required for side-effecting calls.\n- **Session-based serialization**: one active run at a time per session key to avoid tool/state races.\n- **Scheduling inside the Gateway**: cron jobs with main vs isolated session modes; periodic heartbeats drive proactive checks via `HEARTBEAT.md`.\n- **Durable memory via filesystem**: daily logs + curated memory + JSONL transcripts; each agent has isolated workspace/session store/auth profile.\n- **Tool/skill system**: tools defined with TypeBox schemas; skills defined via `SKILL.md` with precedence (workspace > managed > bundled) and load-time gating.\n- **Security layering**: channel policies, tool allow/deny lists, sandboxing (e.g., Docker isolation), exec approvals; fail-closed defaults.\n\n## Relationship to JJ Gateway work\n\nUseful as a reference architecture for a local-first \u001cGateway as control plane\u001d design with per-session serialization and a WS framing protocol (req/res/event + idempotency keys).\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHKH7MWX9B27SKEBRWXNJR"]}]}}
{"ledger_id":"led_01KGAHMXYY9FJCSPB40HT2A8B6","ts":"2026-01-31T17:29:42.110237Z","author":"ingest-agent","reason":"Record the OpenClaw Gateway control-plane architecture and protocol details as system facts/patterns that may inform similar implementations.","op":"upsert_knowledge","doc_path":"knowledge/system/openclaw-gateway-architecture.md","doc_id":"mem_01KGAHMXYXQEPBMV1GHC3ZNPC9","new_hash":"18b1f36359bbf61f2c775fb219dae8590f74da3288322522efa5a19074e5c3c9","patch":{"doc_path":"knowledge/system/openclaw-gateway-architecture.md","title":"OpenClaw Gateway architecture & protocol (system facts)","type":"system","status":"active","tags_add":["openclaw","gateway","websocket","protocol","sessions","cron","heartbeats","idempotency"],"confidence":0.83,"body_append":"## Gateway control plane\n\n- Single long-running daemon is the **central control plane** for messaging, scheduling, and tool execution.\n- Enforces **one Gateway per host**.\n- Owns channel connections (examples: WhatsApp/Baileys, Telegram/grammY, Discord/discord.js, Slack/Bolt).\n- Exposes loopback WebSocket control plane: `ws://127.0.0.1:18789`.\n\n## WebSocket framing protocol\n\n- Frame types:\n  - `req`: client request with `method`/`params`\n  - `res`: server response\n  - `event`: server-push, used for streaming deltas\n- First frame must be authenticated `connect` handshake; otherwise the Gateway hard-closes.\n- Side-effecting methods (e.g., `agent`, `send`) require **idempotency keys** to support safe retries.\n\n## Session model & serialization\n\n- Gateway routes inbound messages to agents via **binding rules** (most-specific-wins matching by channel/account/peer/guild).\n- **Runs are queued per session key** (one active run at a time per session), preventing conversation/tool race conditions.\n- Example session key shapes:\n  - DMs: `agent:<agentId>:<channel>:dm:<peerId>`\n  - Groups: `agent:<agentId>:<channel>:group:<id>`\n\n## Run lifecycle (high level)\n\n1. Intake/validation; persist metadata; immediate ack `{runId, acceptedAt}`\n2. Per-session queueing\n3. Context assembly (workspace files like `AGENTS.md`, `SOUL.md`; skills)\n4. LLM inference with streaming + tool calls\n5. Sandboxed tool execution + result sanitization\n6. Stream `assistant`/`tool` deltas as `event`s\n7. Persist final transcript to JSONL; update token counts\n\n## Scheduling inside Gateway\n\n- Two mechanisms: **cron jobs** and **heartbeats** (no separate scheduler daemon).\n- Cron schedule types: `at` (one-shot), `every` (fixed interval), `cron` (cron expression).\n- Cron session modes:\n  - `main`: inject a system event into existing main session\n  - `isolated`: run in new session `cron:<jobId>` and post result back to main\n- Heartbeats: periodic turns in main session (default every 30 minutes) guided by `HEARTBEAT.md`; can return `HEARTBEAT_OK` to suppress messages.\n- Cron persistence: `~/.openclaw/cron/jobs.json`; concurrency bounded by `maxConcurrentRuns`.\n\n## Agent-to-agent coordination (optional)\n\n- Disabled by default; enabled via allowlisting.\n- Tools:\n  - `sessions_send` (bounded ping-pong)\n  - `sessions_spawn` (isolated sub-agent runs)\n- Sub-agent session keys: `agent:<agentId>:subagent:<uuid>`.\n- Sub-agents typically cannot recursively spawn further sub-agents.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHKH7MWX9B27SKEBRWXNJR"]}]}}
{"ledger_id":"led_01KGAHNBYW36Y34RV0DRGVGAW4","ts":"2026-01-31T17:29:56.444507Z","author":"ingest-agent","reason":"Add a source summary for the provided 'company' document capturing LoopWork context, status, team, and strategic options.","op":"upsert_knowledge","doc_path":"summaries/sources/company.md","doc_id":"mem_01KGAHNBYWMHZX7M4KZQX0VXW8","new_hash":"231f2b0cc6d308bc3c5204ff3fcc878b0b972db2d7a99b524602d73b1744f330","patch":{"doc_path":"summaries/sources/company.md","title":"LoopWork - Company Context (source summary)","type":"source_summary","status":"active","tags_add":["loopwork","company-context","pre-product"],"confidence":0.9,"body_append":"## Summary\nLoopWork is a pre-product company exploring product–market fit with roughly **$2M cash runway**. The stated focus for **Q1 2025** is building “**Cursor/Claude Code for media**”: AI-assisted creative tooling, **starting with images** in Q1 and expressing interest in **video next**.\n\nThe team consists of **Jesse Andrews (CTO, Berkeley, CA; GitHub @anotherjesse)** and **Carl Peaslee (CEO, San Francisco, CA; GitHub @carlpeaslee)**. Jesse’s background includes initiating and building **OpenStack at NASA**, leading product/engineering at **Planet.com** (growing an org to ~75), and deep AI work (2018–2021) including **embeddings** and **autoencoders**, plus multiple open source projects including **userscripts.org**. An explicit belief/insight attributed to Jesse is that LLMs can **bridge communication gaps across disciplines** (e.g., legal/product/engineering/marketing).\n\nLoopWork’s current status is described as: cash runway secured, but **product not yet defined**, **no MVP**, **no first users**, and **no revenue/market awareness** yet.\n\nPreviously, the company worked on **Vibewire**, a dev-tools concept; some parts remain used internally. LoopWork pivoted away from dev tools due to perceived oversaturation and heavy investment by major model companies.\n\nTwo strategic options are outlined: (1) a **product path** focused on building toward revenue, and (2) an **awareness path** focused on reputation-building with potential **acquihire** outcomes.\n\n*Document last updated: 2025-01-23.*","sources_add":[{"thread_id":"","event_ids":["src_01KGAHMHCW60JR4TWZ1X6Q1C9M"]}]}}
{"ledger_id":"led_01KGAHNBYXK8HDH6V7Z3S8C16F","ts":"2026-01-31T17:29:56.445598Z","author":"ingest-agent","reason":"Update the existing LoopWork project doc with additional current-status checklist and strategic options from this source, and align snapshot date.","op":"upsert_knowledge","doc_path":"knowledge/projects/loopwork.md","doc_id":"mem_01KGAHFNG64TGPDAAK8S7XM98S","prev_hash":"2e9e3f240ee8d46a59ebd567068e0dd673719c8913801abd40294d547da0494d","new_hash":"89f1e52bb547883dc720e81e26785a77c3be98bb6fb85a184f7deefe6e7458c6","patch":{"doc_path":"knowledge/projects/loopwork.md","confidence":0.88,"body_append":"\n\n## Current status (as stated, 2025-01-23)\n- [x] Cash / runway (~$2M)\n- [ ] Product defined (exploring “AI for media”)\n- [ ] MVP built\n- [ ] First users\n- [ ] Revenue / market awareness\n\n## Strategic options (as stated)\n1. **Product path**: build toward revenue.\n2. **Awareness path**: build reputation for potential **acquihire**.\n\n## Team (identifiers)\n- Jesse Andrews (CTO) GitHub: **@anotherjesse**; Berkeley, CA.\n- Carl Peaslee (CEO) GitHub: **@carlpeaslee**; San Francisco, CA.\n\n## Notes\n- Interest expressed in expanding from **images** to **video** after the initial focus.","sources_add":[{"thread_id":"","event_ids":["src_01KGAHMHCW60JR4TWZ1X6Q1C9M"]}]}}
{"ledger_id":"led_01KGAHNBYY89A9HN8J41F4G17G","ts":"2026-01-31T17:29:56.446137Z","author":"ingest-agent","reason":"Update Jesse Andrews person doc with specific GitHub handle, additional career details (Planet Fellow; early LLM conviction trigger), and the explicit insight about LLMs bridging disciplines.","op":"upsert_knowledge","doc_path":"knowledge/people/jesse-andrews.md","doc_id":"mem_01KGAHFNG411EGWX99WTQR7S7Q","prev_hash":"1748b130c299439abafee78c7a01c2b28b41927ddc821ab015eead13aab0c06c","new_hash":"dab3f70b391044c4e8c2e08ac7dbf73c1067cec270d5529c40af8be839107a1c","patch":{"doc_path":"knowledge/people/jesse-andrews.md","confidence":0.9,"body_append":"\n\n## Identifiers\n- GitHub: **@anotherjesse**\n- Location: **Berkeley, CA**\n\n## Additional background (as stated)\n- At **Planet.com**: SVP Product/Eng; later **Fellow**.\n- Early LLM conviction attributed to seeing **Riley Goodside’s GPT-3 Graphviz demo**.\n\n## Stated insight\n- LLMs can help **bridge communication gaps across disciplines** (e.g., legal/product/engineering/marketing use different “languages”).","sources_add":[{"thread_id":"","event_ids":["src_01KGAHMHCW60JR4TWZ1X6Q1C9M"]}]}}
{"ledger_id":"led_01KGAHNBYY1WVKPTPFPQ7DP4KD","ts":"2026-01-31T17:29:56.446792Z","author":"ingest-agent","reason":"Update Carl Peaslee person doc with last name, GitHub handle, and note that he is technical + GTM-capable.","op":"upsert_knowledge","doc_path":"knowledge/people/carl-loopwork.md","doc_id":"mem_01KGAHFNG5CYPBCMPZXSJHHGMZ","prev_hash":"657e832556b7b9ba364f7147e2c45ea2321a9648dad869969d913e614e9671aa","new_hash":"68ba2841172c3fe2caae8ab9e9f83dd9ac8f8de4dc1357666558adc3c7da266c","patch":{"doc_path":"knowledge/people/carl-loopwork.md","confidence":0.85,"body_append":"\n\n## Identifiers\n- Full name: **Carl Peaslee**\n- GitHub: **@carlpeaslee**\n- Location: **San Francisco, CA**\n\n## Background (as stated)\n- Described as **technical + business**: can code and also do **GTM**.","sources_add":[{"thread_id":"","event_ids":["src_01KGAHMHCW60JR4TWZ1X6Q1C9M"]}]}}
{"ledger_id":"led_01KGAHNHKM67P6VGKBSH9RPCYA","ts":"2026-01-31T17:30:02.228973Z","author":"ingest-agent","reason":"Create a project doc for Vibewire, the prior dev-tools concept mentioned in the company context source.","op":"upsert_knowledge","doc_path":"knowledge/projects/vibewire.md","doc_id":"mem_01KGAHNHKM9A96KPNQKW30A95Z","new_hash":"02527438aeb2743de7279c1156644e0a3928dbeb122a01ea84e989010d7d7e8a","patch":{"doc_path":"knowledge/projects/vibewire.md","title":"Vibewire","type":"project","status":"active","tags_add":["loopwork","dev-tools","archived-or-pivoted"],"confidence":0.78,"body_append":"## Overview\n- **Vibewire** was a prior **dev tools** concept associated with LoopWork.\n- The company **pivoted away** from dev tools, citing the space as **oversaturated** and noting that large model companies are investing heavily.\n- Some parts of Vibewire are **still used internally**.\n\n## Status\n- Not the current product direction; considered a **previous effort**.\n\n## Relationship to current direction\n- LoopWork’s current exploration is “**Cursor/Claude Code for media**” (AI-assisted creative tools), distinct from Vibewire’s dev-tools focus.","sources_add":[{"thread_id":"","event_ids":["src_01KGAHMHCW60JR4TWZ1X6Q1C9M"]}]}}
{"ledger_id":"led_01KGAHPPBNVRQN304SWKB7CFWR","ts":"2026-01-31T17:30:39.861496Z","author":"ingest-agent","reason":"Create a source summary for the provided roadmap document and store it under summaries/sources/roadmap.md.","op":"upsert_knowledge","doc_path":"summaries/sources/roadmap.md","doc_id":"mem_01KGAHPPBN0QRJS3XMN4ZQQCB2","new_hash":"af56845d07685911f6ff5ca4534c2c89d10fda58993a190d7b265d45d380f2bf","patch":{"doc_path":"summaries/sources/roadmap.md","title":"roadmap (technical roadmap document)","type":"source_summary","tags_add":["roadmap","planning","template"],"confidence":0.85,"body_append":"## Summary\nThis source is a **generic technical roadmap template** with checklists and placeholders, intended to track progress from early discovery through launch and iteration.\n\n- **Current phase:** *Discovery & Definition*.\n- **Milestone structure:** Four phases with high-level tasks:\n  1. **Foundation:** define product scope, choose technical stack, set up dev environment, create initial architecture.\n  2. **MVP:** implement three unspecified core features and a basic deployment pipeline.\n  3. **Launch:** add user authentication, production infrastructure, monitoring/alerting, and perform the initial launch.\n  4. **Iteration:** integrate user feedback, optimize performance, and expand features.\n- **Sprint tracking:** includes a section for the **week of 2025-01-23** with empty “This Week” and “Next Week” task lists.\n- **Backlog:** placeholder section with no items filled in.\n\n## Notable gaps / to be completed\n- No product-specific scope, features, owners, or definitions of “Core feature 1–3”.\n- No dates (beyond the sprint week) or acceptance criteria for milestones.\n\n*Last updated in source: 2025-01-23.*","sources_add":[{"thread_id":"","event_ids":["src_01KGAHPAMA3VCX1C9AWMNSZRF2"]}]}}
{"ledger_id":"led_01KGAHPVRFKE8XD1AAHZPNM8S0","ts":"2026-01-31T17:30:45.391196Z","author":"ingest-agent","reason":"Extract the roadmap structure as a reusable system/process fact; no people or concrete project details are present.","op":"upsert_knowledge","doc_path":"knowledge/system/roadmap-template.md","doc_id":"mem_01KGAHPVREW6RSG8GX3ZVWTRJC","new_hash":"1e30ad3fa471dc077dbcc7a1564b2a0baa84e31dc65d5010e5ef0d06b5e4ce3d","patch":{"doc_path":"knowledge/system/roadmap-template.md","title":"Roadmap template (phases + checklist)","type":"system","tags_add":["roadmap","process","template"],"confidence":0.8,"body_append":"## Technical roadmap template (as of 2025-01-23)\nA generic four-phase product/engineering roadmap structure:\n\n1. **Discovery & Definition** (current phase marker)\n2. **Phase 1: Foundation**\n   - Define product scope\n   - Choose technical stack\n   - Set up development environment\n   - Create initial architecture\n3. **Phase 2: MVP**\n   - Build 3 core features (placeholders)\n   - Basic deployment pipeline\n4. **Phase 3: Launch**\n   - User authentication\n   - Production infrastructure\n   - Monitoring & alerting\n   - Initial launch\n5. **Phase 4: Iteration**\n   - Integrate user feedback\n   - Performance optimization\n   - Feature expansion\n\n## Sprint cadence fields included\n- Weekly focus section with **This Week** and **Next Week** task slots.\n- Backlog placeholder section.\n\n## Notes\n- This is not tied to a specific project in the source; it is a reusable checklist template.","sources_add":[{"thread_id":"","event_ids":["src_01KGAHPAMA3VCX1C9AWMNSZRF2"]}]}}
{"ledger_id":"led_01KGAHRHBR2GZY2DK0KT0FW3HM","ts":"2026-01-31T17:31:40.280009Z","author":"ingest-agent","reason":"Add a source summary for the provided 'sparks' document so the corpus retains the full set of details (features, philosophy, volumes, and validated snapshot capability).","op":"upsert_knowledge","doc_path":"summaries/sources/sparks.md","doc_id":"mem_01KGAHRHBQQ0VJS66BT0Z4WFB1","new_hash":"885aaa9bc0f98650a8a608196f8bd8733b1a303af046060d06d9046c468b8c52","patch":{"doc_path":"summaries/sources/sparks.md","title":"Sparks (source: src_01KGAHQM5C1W0DZ2N3XS49GQPP)","type":"source_summary","tags_add":["loopwork","sparks","infrastructure","agentic-compute"],"confidence":0.9,"body_append":"## Summary\nSparks is a LoopWork project that provides **instant sandbox environments** (“sparks”) with **persistent filesystems**. Each spark runs in an **isolated container** with its own root filesystem, backed by **btrfs snapshots** for fast cloning and restore. The repo is `github.com/loopwork/sparks` and the local path is `~/lw/sparks`. It is implemented in **Rust** and is described as Jesse’s first Rust project (with the motto “if it compiles, it works”). Sparks is presented as a spiritual successor to **Vibewire**, a previous monolithic Elixir system.\n\nThe product philosophy emphasizes a **simple CLI** that does one thing well, with a clear division of responsibilities: **coding agents** own the code and tests, while **humans own verification** via QA/smoke tests; agent-written tests passing are treated as necessary but not sufficient (“outsourced dev” analogy).\n\nCore CLI capabilities include lifecycle management (`spark create/delete/stop/resume`), command execution and shells (`spark exec/console`), snapshotting (`spark snapshot create/restore`), templating (`spark base`), persistent volumes across sparks (`spark data`), and secrets management via **1Password integration** (`spark secrets`). Sparks supports “projects” for namespace isolation (auto-detected from git repos) and **ephemeral sparks** designated with `-` that auto-delete on exit.\n\nSparks auto-mounts shared volumes: `/spark/bin` (global executables), `/spark/all` (global shared data), and `/spark/proj` (per-project shared data).\n\nStrategically, Sparks is framed as “**agentic-first cloud compute**”: infrastructure that makes agentic workloads feel like cloud did for VMs (time/space shifting, scale up/down). A key motivation is the “**deadness**” of freezing agent-built experiences into static apps; Sparks explores blurred boundaries between dev mode vs shipped product and human collaboration mediated by agents. A validated capability (2025-01-24) is that **hard btrfs snapshots work with stateful apps** like Postgres without coordination (WAL crash recovery suffices), supporting “fork anything anytime.”\n\n(Last updated in source: 2025-01-23)\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHQM5C1W0DZ2N3XS49GQPP"]}]}}
{"ledger_id":"led_01KGAHRHBSBC6W6D26XXE6KMBW","ts":"2026-01-31T17:31:40.281439Z","author":"ingest-agent","reason":"Update the existing Sparks project doc with concrete technical and product details from the new source (CLI surface area, volumes, repo, and validated snapshot behavior).","op":"upsert_knowledge","doc_path":"knowledge/projects/sparks.md","doc_id":"mem_01KGAHFNG68QP9XNES1WAH76PT","prev_hash":"a06ca9f60464f12efdc85a3b8b9c3e6069c86e22b762855cd0b57b23499f7a13","new_hash":"e87b8af516c292914903da549996c59fd88dbc7185d39f391eb101456efadc31","patch":{"doc_path":"knowledge/projects/sparks.md","tags_add":["rust","btrfs","containers","cli"],"confidence":0.9,"body_append":"\n\n## Repo / location / implementation\n- Repo: `https://github.com/loopwork/sparks`\n- Local: `~/lw/sparks`\n- Language: **Rust** (described as Jesse’s first Rust project; motto: “if it compiles, it works”).\n- Architecture: each spark runs in an **isolated container** with its own root filesystem; persistence and cloning via **btrfs snapshots**.\n- Lineage: described as a spiritual child of **Vibewire** (previous monolithic Elixir system).\n\n## Philosophy / operating model\n- Prefer a **simple CLI** that does one thing well vs an “all-in-one monster.”\n- **Coding agents** own code and tests; **humans** own verification flow (QA/smoke tests).\n- Treat agents like “outsourced dev”: passing tests does not imply the outcome is correct for the user/product.\n\n## CLI surface area (as described)\n- Lifecycle: `spark create/delete/stop/resume`\n- Execution: `spark exec/console`\n- Snapshots: `spark snapshot create/restore`\n- Templates: `spark base` (save spark as a template)\n- Shared/persistent data: `spark data` (volumes across sparks)\n- Secrets: `spark secrets` (1Password integration)\n- Projects: namespace isolation (auto-detected from git repos)\n- Ephemeral mode: use `-` to auto-delete a spark on exit\n\n## Auto-mounted volumes\n- `/spark/bin` — shared executables (global)\n- `/spark/all` — shared data (global)\n- `/spark/proj` — shared data (per project)\n\n## Validated capability\n- **Hard snapshots with stateful apps** (2025-01-24): Postgres survived unannounced btrfs snapshots via WAL crash recovery; implies practical “fork anything anytime” without app coordination.\n\n## Status (week of 2025-01-23)\n- Focus: making Sparks capable of developing itself by moving development “onto the inside.”\n- Open questions: git workflows; source vs data separation; trust/canonical truth.\n- Goal: composable “LEGOs that snap together,” making Sparks faster than alternatives; evolving from “verification passes” to a development accelerant.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHQM5C1W0DZ2N3XS49GQPP"]}]}}
{"ledger_id":"led_01KGAHRS3YD85AXSBDQ2E0YAH1","ts":"2026-01-31T17:31:48.222457Z","author":"ingest-agent","reason":"Create a discrete system-fact doc capturing the specifically dated, validated capability (Postgres surviving unannounced btrfs snapshots), which is useful independently of the general Sparks project description.","op":"upsert_knowledge","doc_path":"knowledge/system/sparks-validated-snapshots-postgres.md","doc_id":"mem_01KGAHRS3Y51J4S3M53AREKDRQ","new_hash":"806befe38f1297b64712db40d7f4fb70363105f1bf6cafea50fed894ad7ec11c","patch":{"doc_path":"knowledge/system/sparks-validated-snapshots-postgres.md","title":"Sparks: validated btrfs snapshots with Postgres","type":"system","tags_add":["sparks","btrfs","postgres","snapshots","validated-capability"],"confidence":0.85,"body_append":"## Statement\nOn **2025-01-24**, Sparks validated that **hard btrfs snapshots** taken without coordinating with the application can work even for **stateful apps**: **Postgres** survived “unannounced” snapshots, relying on **WAL crash recovery** on restart.\n\n## Implication\nSupports the claim that Sparks can effectively **“fork anything anytime”**—i.e., snapshot/fork running environments without app-level quiescing protocols.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHQM5C1W0DZ2N3XS49GQPP"]}]}}
{"ledger_id":"led_01KGAHS034BAANXDQ17VJBP6EZ","ts":"2026-01-31T17:31:55.364800Z","author":"ingest-agent","reason":"Capture a reusable operating preference from the Sparks document about division of responsibilities between coding agents and humans in verification.","op":"upsert_knowledge","doc_path":"knowledge/prefs/agents-vs-humans-verification-sparks.md","doc_id":"mem_01KGAHS0340FZJ5BJ302VM2T3A","new_hash":"931c964ca169fd4a16f68c25af2d5027f711ebf8da2452ab8cec3ea8305c810e","patch":{"doc_path":"knowledge/prefs/agents-vs-humans-verification-sparks.md","title":"Agents write code/tests; humans verify (Sparks philosophy)","type":"preference","tags_add":["agents","verification","testing","sparks","process"],"confidence":0.8,"body_append":"## Preference / principle\nWhen using coding agents:\n- **Agents own implementation + tests** (they can write code, add/modify tests, and make the test suite pass).\n- **Humans own verification** (QA, smoke tests, and deciding whether behavior is actually correct/desirable).\n\n## Rationale / framing\nTreat coding agents like **outsourced developers**: passing their tests is not sufficient evidence that the result matches your intent.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHQM5C1W0DZ2N3XS49GQPP"]}]}}
{"ledger_id":"led_01KGAHTRP889GRHSF9NA8KGNP4","ts":"2026-01-31T17:32:53.320091Z","author":"ingest-agent","reason":"Create a concise source summary of the provided CTO priorities document for later reference and planning alignment.","op":"upsert_knowledge","doc_path":"summaries/sources/priorities.md","doc_id":"mem_01KGAHTRP7MB7THJY9XXFJVQZH","new_hash":"ebba3c5bbacb7054bf6420cd64842e86837a58589eba3df61907e8292172a464","patch":{"doc_path":"summaries/sources/priorities.md","title":"CTO Priorities (Carl sync 2025-01-23)","type":"source_summary","status":"active","tags_add":["priorities","loopwork","sparks","roadmap"],"confidence":0.82,"body_append":"## Summary\nThis document captures LoopWork/Sparks CTO priorities as of a Carl sync on **2025-01-23** (last updated **2025-01-24**). The immediate track shows several infrastructure items completed/validated: a **TMUX sizing fix** (done), **Postgres snapshot patterns** validated (hard btrfs snapshots require no Postgres coordination; WAL crash recovery tolerates unannounced snapshots; enables fast DB forking, test fixtures, and migration rollback), and **SSH improvements** with tests passing (multi-connection + SFTP; a Zed hang appears to be a general Linux issue, not Sparks-specific).\n\nA key near-term deliverable is the **`spark-pg` service** (working as of 2025-01-25), implementing `spark-pg new/fork/connect/status` using the `spark-client` crate directly. This establishes a reusable pattern for additional services (e.g., Redis), with an open design question around how much complexity should live “inside” Spark vs outside.\n\nTwo urgent platform priorities remain: **Dev Spark containers with KVM** and **Dev/Prod unification** (explicitly labeled new + blocking). The latter aims to eliminate divergent dev vs prod scripts/flows/settings in favor of a single pathway with a flag difference, spanning deploy/setup/verify.\n\nThe **current top 3 priorities** are: (1) **Sparks self-hosting development**—make Sparks able to develop itself (trust, git workflows, and source vs data boundaries) with a goal of composable “LEGOs” that snap together faster than alternatives; (2) **internal tooling for LoopWork**, including moving from iMessage to a first Spark-native app (“Loop chat”), building voice call/session logging, a shared skills repo at `loop.work/skills`, and broad **conversation recording** (chats/calls/Claude sessions) so future AI can browse history for context; and (3) **agentic imagery exploration** (“Cursor for images”), with Q1 focus on images then video, referencing patterns like Prologue CAD (generate variations, rapid human eval, genetic algorithms).\n\nOpen questions include a port **8080 documentation gap** for standardized HTTP service patterns, skills repo structure (manual sync → CLI), and external vs internal separation for Picnic. Parking-lot integrations include Granola transcripts, Readwise Reader sync, and an automated changelog service.","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHVGBSPDA5NVG013D4C113","ts":"2026-01-31T17:33:17.561379Z","author":"ingest-agent","reason":"Capture the spark-pg service as a discrete project/service component with its CLI surface and open design question.","op":"upsert_knowledge","doc_path":"knowledge/projects/spark-pg.md","doc_id":"mem_01KGAHVGBS5W0162HPXRAX5AVA","new_hash":"99fbf40baead97936a9c54de95418c8b7fe1e85d599168bb6b639773711a0619","patch":{"doc_path":"knowledge/projects/spark-pg.md","title":"spark-pg service","type":"project","status":"active","tags_add":["sparks","postgres","service","cli"],"confidence":0.78,"body_append":"## Overview\n`spark-pg` is a Sparks-adjacent service that provides Postgres lifecycle operations (create/fork/connect/status) as a dedicated command surface.\n\n## Status\n- Working as of **2025-01-25**.\n\n## CLI\n- `spark-pg new`\n- `spark-pg fork`\n- `spark-pg connect`\n- `spark-pg status`\n\n## Implementation notes\n- Uses the `spark-client` crate directly.\n- Intended as a pattern for additional service wrappers (e.g., Redis).\n\n## Open design question\n- How much complexity should live **inside Spark** vs **outside Spark** (in standalone services like `spark-pg`).\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHVGBT7F65TBW6QNJ90XDF","ts":"2026-01-31T17:33:17.562082Z","author":"ingest-agent","reason":"Record the blocking platform requirement to unify dev/prod flows into a single flagged path.","op":"upsert_knowledge","doc_path":"knowledge/system/dev-prod-unification.md","doc_id":"mem_01KGAHVGBSG0BZYHRSZM2BAF1P","new_hash":"4e382a221f3c9ca20596d97774bfa4538712c08abdc7c288af45fbaf9aef0ff4","patch":{"doc_path":"knowledge/system/dev-prod-unification.md","title":"Dev/Prod unification (single-path flows)","type":"system","status":"active","tags_add":["sparks","devops","workflow"],"confidence":0.8,"body_append":"## Statement\nAs of **2025-01-23**, LoopWork identified **Dev/Prod unification** as a *new, blocking* priority.\n\n## Problem\n- Dev and prod currently use **different scripts/flows/settings**.\n\n## Target\n- A **single path** for workflows with only a **flag difference** between dev and prod.\n\n## Affected areas\n- Deploy\n- Setup\n- Verify\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHVGBT6TN5N5DM5ZCS6991","ts":"2026-01-31T17:33:17.562550Z","author":"ingest-agent","reason":"Track the concrete near-term infrastructure goal to run dev Spark containers with KVM.","op":"upsert_knowledge","doc_path":"knowledge/projects/dev-spark-containers-kvm.md","doc_id":"mem_01KGAHVGBT7VPWJNZHFW9GGQBE","new_hash":"8ec12037594288e647e3128000bc58faa4bc6ca834599675c31af856e80cec6c","patch":{"doc_path":"knowledge/projects/dev-spark-containers-kvm.md","title":"Dev Spark containers with KVM","type":"project","status":"active","tags_add":["sparks","kvm","dev-environment","containers"],"confidence":0.7,"body_append":"## Goal\nEnable **development Spark containers using KVM**.\n\n## Priority\nListed as an immediate CTO priority (Carl sync **2025-01-23**).\n\n## Notes\nNo implementation details provided in this source; treated as an active workstream related to improving the dev environment for Sparks.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHVGBTNCQ90HVPPXX2YS0K","ts":"2026-01-31T17:33:17.562961Z","author":"ingest-agent","reason":"Capture the Loop chat initiative as a discrete project since it is positioned as the first Spark-native app and internal tooling priority.","op":"upsert_knowledge","doc_path":"knowledge/projects/loop-chat.md","doc_id":"mem_01KGAHVGBTN4300DR1EY9KQDDD","new_hash":"c18654d934bf71ee1c632d6ea15fcc7c2ee7f0c4076ff700e9d4886240a6e8fd","patch":{"doc_path":"knowledge/projects/loop-chat.md","title":"Loop chat (internal chat; first Spark-native app)","type":"project","status":"active","tags_add":["loopwork","sparks","internal-tooling","chat"],"confidence":0.76,"body_append":"## Overview\nLoop chat is an internal chat tool intended to replace iMessage for LoopWork and serve as the **first Spark-native app**.\n\n## Product idea\n- Chat channels could spawn **dedicated Spark instances** as part of the application model (\"Spark Native Apps\").\n\n## Related internal-tooling goals\n- Voice call/session logging with Carl.\n- Shared skills repo: `loop.work/skills`.\n- Conversation recording so future AI can browse history (chats, calls, Claude Code sessions).\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHVGBV9SQCA81CZ6PH4VJC","ts":"2026-01-31T17:33:17.563427Z","author":"ingest-agent","reason":"Track the exploration thread about agentic imagery as a named effort and connect it to the stated Q1 focus and referenced pattern (Prologue CAD).","op":"upsert_knowledge","doc_path":"knowledge/projects/agentic-imagery-exploration.md","doc_id":"mem_01KGAHVGBVGJJD4K4HX83PM655","new_hash":"48bc65f60c232707f575a8eaa2987242cc24c3eb7b736894c09fa89450ae854c","patch":{"doc_path":"knowledge/projects/agentic-imagery-exploration.md","title":"Agentic imagery exploration (\"Cursor for images\")","type":"project","status":"active","tags_add":["loopwork","media","images","agents","research"],"confidence":0.74,"body_append":"## Goal\nExplore what a **\"Cursor for images\"** could be: an agentic workflow for generating and iterating on images with human-in-the-loop evaluation.\n\n## Scope / sequencing\n- Q1 focus: **images first**, then **video** after images are validated.\n\n## Questions\n- What does \"agenticness\" mean for media workflows?\n\n## Related reference\n- Mentions MattF's **Prologue CAD** pattern (generate variations, rapid human evaluation, genetic algorithms for creativity); meeting note referenced: `meetings/2026-01-24-mattf-prologue-cad.md`.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHVTNEHX30N233G5DY8RA4","ts":"2026-01-31T17:33:28.110481Z","author":"ingest-agent","reason":"Append newly stated CTO priorities/status items to the existing Sparks project doc without overwriting prior captured details.","op":"upsert_knowledge","doc_path":"knowledge/projects/sparks.md","doc_id":"mem_01KGAHFNG68QP9XNES1WAH76PT","prev_hash":"e87b8af516c292914903da549996c59fd88dbc7185d39f391eb101456efadc31","new_hash":"202a6236cd1cc395dcde3408433c747012977e80cef640b1fde60719027f67de","patch":{"doc_path":"knowledge/projects/sparks.md","confidence":0.8,"body_append":"\n\n## Priorities / near-term work (Carl sync 2025-01-23)\n- **Self-hosting development**: get Sparks to the point where it can develop itself (trust, git workflows, source vs data boundaries).\n- **Service pattern**: `spark-pg` established a pattern for additional services (e.g., Redis); open question about inside-vs-outside Spark complexity.\n- **Dev environment**: Dev Spark containers with **KVM**.\n- **Blocking**: **Dev/Prod unification** (single path with flag differences across deploy/setup/verify).\n- Infra status notes: SSH multi-connection + SFTP working with tests; Zed hang appears not Sparks-specific.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHVTNF0ARFJ8RV2388NZV4","ts":"2026-01-31T17:33:28.111508Z","author":"ingest-agent","reason":"Update LoopWork project doc with the explicit top priorities list from this priorities document.","op":"upsert_knowledge","doc_path":"knowledge/projects/loopwork.md","doc_id":"mem_01KGAHFNG64TGPDAAK8S7XM98S","prev_hash":"89f1e52bb547883dc720e81e26785a77c3be98bb6fb85a184f7deefe6e7458c6","new_hash":"91e31546642037aeb2549688993ec68ec87a065510f50c4505e4430181f9288b","patch":{"doc_path":"knowledge/projects/loopwork.md","confidence":0.78,"body_append":"\n\n## Priorities (as of 2025-01-23)\n- **Sparks self-hosting development**: make the infrastructure develop itself.\n- **Internal tooling**:\n  - Replace iMessage with **Loop chat** (first Spark-native app).\n  - Voice call/session logging with Carl.\n  - Shared skills repo at `loop.work/skills`.\n  - **Conversation recording** across chats/calls/Claude Code sessions so future AI can browse history.\n- **Agentic imagery exploration**: investigate \"Cursor for images\"; Q1 focus on images then video.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHVTNGQ4QDBMMD2RNBYCPA","ts":"2026-01-31T17:33:28.112445Z","author":"ingest-agent","reason":"The priorities doc reiterates and strengthens the AI context corpus goal; append the specific phrasing about recording all conversations.","op":"upsert_knowledge","doc_path":"knowledge/system/ai-context-corpus.md","doc_id":"mem_01KGAHFNG7BHAAG5DTF7X0K6K9","prev_hash":"f017ee7ec2b415dc736b8bd10ba9dba862f9bcfe2f6762773ce5faec7a29ecfe","new_hash":"be5731b25842c2fc2e2faa461903c41824c4b35c918a4517f0c28c472e5ebbc7","patch":{"doc_path":"knowledge/system/ai-context-corpus.md","confidence":0.77,"body_append":"\n\n## Additional emphasis (2025-01-23 priorities)\n- Explicit priority to **record all conversations** (Claude Code sessions, chats, calls) so future AI can browse history as needed.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHSVDN8HRDMTRPVTHV8MMW"]}]}}
{"ledger_id":"led_01KGAHYTZ294GZH46P6SVBD13N","ts":"2026-01-31T17:35:06.722038Z","author":"ingest-agent","reason":"Add source summary for the provided reference collection so it can be cited and reused across other notes.","op":"upsert_knowledge","doc_path":"summaries/sources/ai-agentic-patterns.md","doc_id":"mem_01KGAHYTZ14YD53NAX02QEPBPK","new_hash":"dfe1a3ad8dd8104071f83d3db5e43fa8eea50350794b7e1ee084f638d7fab3b3","patch":{"doc_path":"summaries/sources/ai-agentic-patterns.md","title":"AI & Agentic Patterns — Reference Collection (source summary)","type":"source_summary","status":"active","tags_add":["agents","context-management","feedback-loops","verification","tooling","reading","creativity"],"confidence":0.86,"body_append":"## Summary\nThis document is a curated reference collection of patterns for making AI agents effective in software and creative workflows, emphasizing **tight feedback loops**, **context management**, and **verification via automation**.\n\nA central theme is **“back pressure”**: agents perform better when the environment continuously surfaces correctness signals (build/type errors, tests, lint, UI assertions) so the agent can self-correct without consuming human review time. Banay’s *Don’t Waste Your Back Pressure* argues that you should stop spending human attention on trivial mistakes and instead give agents the ability to run builds/tests, interpret errors, and iterate until inconsistencies are eliminated; typed languages and high-quality error messages (e.g., Rust/Elm) act as natural back pressure. The collection also points to iterative “loop” styles (e.g., RALPH loops) and UI verification via browser/screenshot automation.\n\nPractitioner workflow guidance (Peter Steinberger’s *Shipping at Inference-Speed*) claims that with modern coding models (GPT‑5.2/Codex), the bottleneck is inference time and “hard thinking,” not coding. Patterns include running multiple projects in parallel, heavily using queues, asking the model to revise rather than reverting, planning collaboratively then issuing a “build” command, and relying less on reading code line-by-line. Context practices include maintaining per-project docs folders and reusing patterns across repos by referencing other directories.\n\nFactory.ai’s *Agent Readiness* frames inconsistent agent results as primarily a **codebase readiness** issue. It provides eight pillars (pre-commit hooks, environment/build docs, tests, CI/CD, security scanning, CODEOWNERS, branch protection) and maturity levels, recommending actionable metrics like the percentage of repos that are “agent-ready.”\n\nThe collection broadens beyond coding: Joel Simon’s *Lluminate* uses evolutionary search and explicit creativity strategies to counter LLM homogeneity and promote novelty, and fast.ai’s close-reading workflow describes using LLMs to read deeply by summarizing chapters, avoiding spoilers, and generating end-of-chapter context for continuation.\n\nFinally, Cloudflare’s *Code Mode* proposes an architecture where the LLM writes TypeScript that calls MCP tools (rather than calling tools directly), executed in a V8 isolate sandbox with no internet and protected secrets.\n\n## Cross-cutting takeaways (as stated)\n- Context management is foundational (summaries-of-summaries, docs folders, JIT loading).\n- Automated feedback beats human review for correctness.\n- Run many experiments instead of seeking one perfect attempt.\n- Start with CLI interfaces so agents can close the loop.\n- As models improve, reduce scaffolding and rebuild SDLC assumptions around new constraints.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ2SK88FY45DEZZX5AC","ts":"2026-01-31T17:35:06.722755Z","author":"ingest-agent","reason":"Create person record for Banay, cited as author of the back pressure article.","op":"upsert_knowledge","doc_path":"knowledge/people/banay.md","doc_id":"mem_01KGAHYTZ27RQ7FJJAAKZFHWZ4","new_hash":"19e9ec9ce595ef895747995ee6e79fd4ff05579f694c997dd208e85545ffb711","patch":{"doc_path":"knowledge/people/banay.md","title":"Banay","type":"person","status":"active","tags_add":["agents","feedback-loops"],"confidence":0.62,"body_append":"## Mention\n- Author of *Don’t Waste Your Back Pressure* (https://banay.me/dont-waste-your-backpressure/), referenced for the concept of “back pressure” as automated feedback loops that enable agents to self-correct and take on longer-horizon tasks.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ3N8HXP8XVR5JFFA8A","ts":"2026-01-31T17:35:06.723143Z","author":"ingest-agent","reason":"Create person record for Peter Steinberger, cited as author of Shipping at Inference-Speed.","op":"upsert_knowledge","doc_path":"knowledge/people/peter-steinberger.md","doc_id":"mem_01KGAHYTZ2HG3M52S6JJ1WCJTV","new_hash":"c9f2d42f9e302356b0dccbc271755eb0ad6baa1c9887971408f838a81c6aa514","patch":{"doc_path":"knowledge/people/peter-steinberger.md","title":"Peter Steinberger","type":"person","status":"active","tags_add":["ai-workflows","software-engineering"],"confidence":0.75,"body_append":"## Mention\n- Author of *Shipping at Inference-Speed* (Dec 2025): workflow observations on using GPT‑5.2/Codex for parallel project execution, queueing, collaborative planning, and reduced manual code reading.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ3FSGNRA98H3MG2AX1","ts":"2026-01-31T17:35:06.723550Z","author":"ingest-agent","reason":"Create person record for Joel Simon, author of Lluminate.","op":"upsert_knowledge","doc_path":"knowledge/people/joel-simon.md","doc_id":"mem_01KGAHYTZ3ABVKWYC1EB4NQB3E","new_hash":"de32f31b85c2bd61ad96a4116bf97828be63881a84bc76418bff739e7be2cfe5","patch":{"doc_path":"knowledge/people/joel-simon.md","title":"Joel Simon","type":"person","status":"active","tags_add":["generative-art","creativity","evolutionary-algorithms"],"confidence":0.8,"body_append":"## Mention\n- Author of *Lluminate: Creative Exploration with Reasoning LLMs* (Dec 2025) and associated code repository (https://github.com/joel-simon/lluminate).\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ3QH965KTV93YAT9ZF","ts":"2026-01-31T17:35:06.723924Z","author":"ingest-agent","reason":"Create person record for Jeremy Howard as coauthor of the fast.ai close reading post.","op":"upsert_knowledge","doc_path":"knowledge/people/jeremy-howard.md","doc_id":"mem_01KGAHYTZ31WNTM2KXNRFF2FDN","new_hash":"24b75f85eb14a13d7e4c6640df88d968e959b17d8378f0ebcae5b44edeb1f709","patch":{"doc_path":"knowledge/people/jeremy-howard.md","title":"Jeremy Howard","type":"person","status":"active","tags_add":["learning","reading","fastai"],"confidence":0.74,"body_append":"## Mention\n- Coauthor (fast.ai) of *How To Use AI for the Ancient Art of Close Reading* (Jan 2026): describes an LLM-assisted close-reading workflow (PDF→Markdown, summaries as context, spoiler avoidance, chapter-overviews, optional comprehension questions, optional Anki card generation via fastanki).\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ4T45TD6B2FFEX5A3W","ts":"2026-01-31T17:35:06.724282Z","author":"ingest-agent","reason":"Create person record for Eric Ries as coauthor of the fast.ai close reading post.","op":"upsert_knowledge","doc_path":"knowledge/people/eric-ries.md","doc_id":"mem_01KGAHYTZ4Q82VBEMYH3A1A8RT","new_hash":"26a9c22b228aac73aeeb4affb4aa1a9f05fe31c0700ed10fe927c90ec57d1777","patch":{"doc_path":"knowledge/people/eric-ries.md","title":"Eric Ries","type":"person","status":"active","tags_add":["reading","fastai"],"confidence":0.7,"body_append":"## Mention\n- Coauthor (fast.ai) of *How To Use AI for the Ancient Art of Close Reading* (Jan 2026).\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ40M6T0MV5MN1BEW0S","ts":"2026-01-31T17:35:06.724637Z","author":"ingest-agent","reason":"Create person record for Johno Whitaker as coauthor of the fast.ai close reading post.","op":"upsert_knowledge","doc_path":"knowledge/people/johno-whitaker.md","doc_id":"mem_01KGAHYTZ49FTQ0B9BJTMZ45P8","new_hash":"a7e3bc16b0fa2ebf547ed687e93eb6081ee604d0c9736039aa4dd628442ea232","patch":{"doc_path":"knowledge/people/johno-whitaker.md","title":"Johno Whitaker","type":"person","status":"active","tags_add":["reading","fastai"],"confidence":0.7,"body_append":"## Mention\n- Coauthor (fast.ai) of *How To Use AI for the Ancient Art of Close Reading* (Jan 2026).\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ52XZ7782ZMYM0D1CW","ts":"2026-01-31T17:35:06.725104Z","author":"ingest-agent","reason":"Capture Lluminate as a project/tool described with an algorithm and repo link.","op":"upsert_knowledge","doc_path":"knowledge/projects/lluminate.md","doc_id":"mem_01KGAHYTZ4JSXEKM021HEVRQX2","new_hash":"0a9d4ec52ea35b815848f5c18db2ef83722616b9a1eeea190ca14221cc9e5a5d","patch":{"doc_path":"knowledge/projects/lluminate.md","title":"Lluminate","type":"project","status":"active","tags_add":["creativity","evolutionary-search","llm"],"confidence":0.84,"body_append":"## What it is\nA creative exploration system for reasoning LLMs that combats homogeneous outputs using evolutionary pressure plus explicit creative strategies.\n\n## Core loop (as described)\n1. Generate a population summary for context.\n2. Inject a random creative strategy.\n3. Evolve candidates via mutation/crossover.\n4. Embed outputs and score novelty via cosine distance to k nearest neighbors.\n5. Select the most diverse outputs for the next generation.\n\n## Findings (as reported)\n- Mutating existing artifacts (“variation”) beats generating entirely new artifacts.\n- Crossover amplifies novelty the most.\n- Novelty correlates with complexity (longer code tends to explore more novel territory).\n- Higher reasoning levels do not necessarily increase diversity.\n\n## Links\n- Article: https://www.joelsimon.net/lluminate\n- Code: https://github.com/joel-simon/lluminate\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ569KHEZHA6K6GA0CC","ts":"2026-01-31T17:35:06.725490Z","author":"ingest-agent","reason":"Capture Factory.ai Agent Readiness as a project/framework for codebase readiness evaluation.","op":"upsert_knowledge","doc_path":"knowledge/projects/factory-ai-agent-readiness.md","doc_id":"mem_01KGAHYTZ514NGYPNTC48KJQ8S","new_hash":"168d9c1d9d93c7270e3b9a3a3607cfa82a408dda8454f14617bacfd17cc389d3","patch":{"doc_path":"knowledge/projects/factory-ai-agent-readiness.md","title":"Factory.ai — Agent Readiness","type":"project","status":"active","tags_add":["codebase-readiness","ci-cd","agents"],"confidence":0.82,"body_append":"## What it is\nA framework (and associated tooling) for evaluating whether a repository is structured to support reliable AI-agent contributions. The core claim is that uneven agent performance is often caused by poor repo feedback loops, not model quality.\n\n## Eight technical pillars (as listed)\n1. Pre-commit hooks (fast feedback vs long CI waits)\n2. Environment documentation\n3. Build process documentation\n4. Testing infrastructure\n5. CI/CD configuration\n6. Security scanning\n7. Code ownership (CODEOWNERS)\n8. Branch protection\n\n## Maturity levels\n- Level 1: Basic\n- Level 2: Foundational\n- Level 3: Agent-ready (target for most repos)\n- Level 4: Comprehensive\n- Level 5: Exemplary\n\n## Access paths\n- CLI: `/readiness-report` in Factory Droid\n- Dashboard: https://app.factory.ai/analytics/readiness\n- API: programmatic access for CI/CD integration\n\n## Metric guidance\nTrack actionable measures like “% of active repos that are agent-ready” rather than only averages.\n\n## Link\n- https://factory.ai/news/agent-readiness\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ5VKBV94NSW8K1DNDB","ts":"2026-01-31T17:35:06.725879Z","author":"ingest-agent","reason":"Capture Cloudflare Code Mode as a tool architecture pattern/project for using MCP via generated TypeScript code in isolates.","op":"upsert_knowledge","doc_path":"knowledge/projects/cloudflare-code-mode.md","doc_id":"mem_01KGAHYTZ5CF0YNZFWMC4TP1YR","new_hash":"347899ad622a2144b7c9a0261952ee06d4b893d8bd3632aa7718969ea4b0bfed","patch":{"doc_path":"knowledge/projects/cloudflare-code-mode.md","title":"Cloudflare — Code Mode (MCP via TypeScript)","type":"project","status":"active","tags_add":["mcp","tooling-architecture","sandboxing"],"confidence":0.8,"body_append":"## Core idea\nInstead of having an LLM call MCP tools directly, have it **write TypeScript** against an auto-generated API that wraps MCP. Then execute that code as the single tool.\n\n## Why it works (as described)\n- LLMs have extensive TypeScript examples in training data, but limited tool-call exemplars.\n- For multi-step tasks, code can chain tool calls without repeatedly routing intermediate outputs through the model.\n\n## Architecture notes\n- MCP schema → TypeScript API with doc comments.\n- Execute TypeScript in a **V8 isolate** sandbox (fast startup; no containers).\n- No internet access inside the sandbox; only bindings to MCP servers.\n- Secrets/API keys not exposed to generated code.\n- Uses a Worker Loader API for on-demand isolate creation.\n\n## Link\n- https://blog.cloudflare.com/code-mode/\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAHYTZ6DJYWDQJZED7YACGK","ts":"2026-01-31T17:35:06.726239Z","author":"ingest-agent","reason":"Capture 'back pressure' as a reusable system concept/pattern for agent feedback loops.","op":"upsert_knowledge","doc_path":"knowledge/system/agent-back-pressure.md","doc_id":"mem_01KGAHYTZ6VFDXWDJY75QF53E6","new_hash":"6e2c6f1041604fda5db6169dfa9c1ab527998629afc6b428a0653ad39e0081e9","patch":{"doc_path":"knowledge/system/agent-back-pressure.md","title":"Agent back pressure (automated feedback loops)","type":"system","status":"active","tags_add":["agents","feedback-loops","verification"],"confidence":0.8,"body_append":"## Definition (as used in this source)\n**Back pressure** is the automated, continuous feedback an agent receives about quality/correctness (compile errors, types, tests, linters, UI assertions). Strong back pressure enables longer-horizon agent work because mistakes are surfaced and corrected early without consuming human review time.\n\n## Practical implementations mentioned\n- Give agents the ability to run builds/tests and iterate on the resulting errors.\n- Prefer typed languages with expressive type systems (natural correctness constraints).\n- Prefer ecosystems with high-quality error messages (examples cited: Rust, Elm, Python).\n- Use browser/screenshot automation (e.g., Playwright, Chrome DevTools) so agents can verify UI without a human.\n- Loop the agent until inconsistencies are stamped out.\n\n## Reference\n- Banay, *Don’t Waste Your Back Pressure*: https://banay.me/dont-waste-your-backpressure/\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAHWXK99F9EMPAY5CMPCB43"]}]}}
{"ledger_id":"led_01KGAJ0JXPWDQV1WEVQNRGXX5K","ts":"2026-01-31T17:36:04.022074Z","author":"ingest-agent","reason":"Create a source summary for the provided 'Debugging Session' document to make it discoverable and reusable.","op":"upsert_knowledge","doc_path":"summaries/sources/debug.md","doc_id":"mem_01KGAJ0JXNRJKGFV0CJCKTMDNT","new_hash":"e95983d86d8eb982f65af6e1dadc04f095a730f98f5f44bb4fcadc3e83c94749","patch":{"doc_path":"summaries/sources/debug.md","title":"Debugging Session prompts (debug)","type":"source_summary","tags_add":["debugging","prompts","rubber-duck"],"confidence":0.9,"body_append":"## Summary\nThis document defines two reusable prompts intended to structure troubleshooting when stuck on a software bug.\n\n1) **Debugging Session prompt**: Instructs the assistant to first read relevant repo code, then accept a structured problem statement with fields for *expected behavior*, *actual behavior*, *what’s been tried* (as a numbered list), and *error messages/logs* (paste block). The assistant is asked to: (a) form hypotheses about what’s wrong, (b) identify what to investigate next, and (c) suggest fixes. It explicitly requests step-by-step reasoning and encourages asking clarifying questions when needed.\n\n2) **Rubber Duck prompt**: A lighter-weight prompt for talking through a problem. The user explains what they’re trying to do, and the assistant’s role is to ask guiding questions that help the user arrive at the answer themselves.\n\nOverall, the source is a small “runbook” of prompt templates for debugging and self-explanation, emphasizing structured inputs, hypothesis-driven investigation, and iterative clarification.","sources_add":[{"thread_id":"","event_ids":["src_01KGAJ08ZKE85JDWBVDQPKZFV7"]}]}}
{"ledger_id":"led_01KGAJ0R28EB219PJYY14FKV2B","ts":"2026-01-31T17:36:09.288089Z","author":"ingest-agent","reason":"Extract reusable preference/workflow guidance for how JJ wants debugging interactions structured, distinct from general operating style.","op":"upsert_knowledge","doc_path":"knowledge/prefs/debugging-session-prompt.md","doc_id":"mem_01KGAJ0R277S969WRH790NQ7K3","new_hash":"a6301c34afdef8d0c352e5f8afcdf580e16d397af86a7dd333c3c147aa002ee3","patch":{"doc_path":"knowledge/prefs/debugging-session-prompt.md","title":"Debugging session prompt style","type":"preference","tags_add":["debugging","prompting","workflow"],"confidence":0.78,"body_append":"## Preference\nWhen debugging, use a structured intake and hypothesis-driven flow:\n- Capture **expected vs actual behavior**, **what’s been tried**, and **logs/errors**.\n- Start by reading relevant repo code.\n- Then: form hypotheses, identify what to investigate next, and suggest fixes.\n- Use step-by-step reasoning and ask clarifying questions when needed.\n\n## Rubber-duck mode\nIf the user mostly needs to think aloud, switch to a coaching stance: ask guiding questions that help them find the answer themselves.","sources_add":[{"thread_id":"","event_ids":["src_01KGAJ08ZKE85JDWBVDQPKZFV7"]}]}}
{"ledger_id":"led_01KGAJ2J17888V1QPTJFHK8W3B","ts":"2026-01-31T17:37:08.647020Z","author":"ingest-agent","reason":"Create a source summary for the provided 'architecture' document describing the Architecture Decision Session prompt and ADR template.","op":"upsert_knowledge","doc_path":"summaries/sources/architecture.md","doc_id":"mem_01KGAJ2J15F5S2DW73BDP21SZB","new_hash":"dcd25923a84884985f05bbf2ec2d1751889bfe5982d781fe2c6b7d7c827ea7c1","patch":{"doc_path":"summaries/sources/architecture.md","title":"architecture","type":"source_summary","tags_add":["architecture","adr","decision-making","template"],"confidence":0.9,"body_append":"## Summary\nThis document defines a lightweight **Architecture Decision Session** workflow for making significant technical decisions, tailored to a very early-stage startup context.\n\nIt provides a reusable prompt instructing the assistant to first read CTO system context files in `context/`, then help evaluate an explicitly stated **Decision**, its **Context**, and a numbered list of **Options**. The assistant is asked to:\n\n1. Analyze trade-offs for each option.\n2. Prioritize what matters most given the company stage (**2-person, pre-product**).\n3. Assess reversibility (how hard it is to change later).\n4. Recommend an option with rationale.\n5. Surface missing questions that should be asked.\n\nAfter a decision is reached, the assistant should help document it as an **Architecture Decision Record (ADR)** saved under `decisions/NNNN-title.md` using the included template. The ADR template includes: title `ADR-NNNN`, status (Proposed/Accepted/Deprecated/Superseded), context, decision, consequences, alternatives considered, and a date line.\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAJ235S6J8WRPQ22AXRRMA1"]}]}}
{"ledger_id":"led_01KGAJ2ZZ19TFP9NGNW3MMD72X","ts":"2026-01-31T17:37:22.913534Z","author":"ingest-agent","reason":"Capture a reusable system workflow/template: how to run an architecture decision session and how to record the result as an ADR in decisions/.","op":"upsert_knowledge","doc_path":"knowledge/system/architecture-decision-session.md","doc_id":"mem_01KGAJ2ZZ1N88XVBZ08KX5721B","new_hash":"43617004a802a0f6ba356ea244598be6325adfa99e0b550d97a0eef644eea9a7","patch":{"doc_path":"knowledge/system/architecture-decision-session.md","title":"Architecture Decision Session + ADR template","type":"system","tags_add":["architecture","workflow","adr","decisions"],"confidence":0.88,"body_append":"## Architecture Decision Session\nA reusable session flow for making significant technical decisions.\n\n### When to use\n- When a meaningful architecture/technical decision is needed (i.e., not a minor implementation detail).\n\n### Inputs (prompt structure)\n- **Decision**: what is being decided.\n- **Context**: why it matters now.\n- **Options**: numbered list of candidate approaches.\n\n### Assistant tasks\n1. Trade-offs of each option.\n2. What matters most given stage (**2-person, pre-product**).\n3. Reversibility of the decision.\n4. Recommendation + rationale.\n5. Missing questions to ask.\n\n### Output: ADR\n- After deciding, document in **ADR** format under `decisions/`.\n- File naming: `decisions/NNNN-title.md`.\n\n#### ADR template fields\n- Title: `ADR-NNNN: [Title]`\n- Status: Proposed | Accepted | Deprecated | Superseded\n- Context\n- Decision\n- Consequences\n- Alternatives Considered\n- Date line: `*Date: YYYY-MM-DD*`\n","sources_add":[{"thread_id":"","event_ids":["src_01KGAJ235S6J8WRPQ22AXRRMA1"]}]}}
